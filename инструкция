–ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ yc CLI –Ω–∞—Å—Ç—Ä–æ–µ–Ω:

bash
yc config list
–®–∞–≥ 4: –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
bash
cd ansible
./inventory/generate_inventory.sh
–ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ ansible/inventory/hosts:

ini
[web_servers] web-server-1 ansible_host=192.168.20.10 ansible_user=ubuntu
[web_servers] web-server-2 ansible_host=192.168.20.11 ansible_user=ubuntu
[monitoring] prometheus-vm ansible_host=192.168.20.20 ansible_user=ubuntu
[monitoring] grafana-vm ansible_host=192.168.20.21 ansible_user=ubuntu
[logging] elasticsearch-vm ansible_host=192.168.20.30 ansible_user=ubuntu
[logging] kibana-vm ansible_host=192.168.20.31 ansible_user=ubuntu
[bastion] bastion-host ansible_host=192.168.10.10 ansible_user=ubuntu

[all:vars]
ansible_ssh_private_key_file=~/.ssh/id_rsa
–®–∞–≥ 5: –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è —Å–∫—Ä–∏–ø—Ç–∞ (–µ—Å–ª–∏ –Ω–µ—Ç jq)
–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å jq, —Å–æ–∑–¥–∞–π—Ç–µ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç generate_inventory_simple.sh:

bash
#!/bin/bash

echo "–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ inventory"
echo "–°–∫–æ–ø–∏—Ä—É–π—Ç–µ IP –∞–¥—Ä–µ—Å–∞ –∏–∑ –≤—ã–≤–æ–¥–∞ –∫–æ–º–∞–Ω–¥—ã:"
echo "yc compute instance list"

echo "–ó–∞—Ç–µ–º –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª ansible/inventory/hosts –≤—Ä—É—á–Ω—É—é"
–®–∞–≥ 6: –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
bash
cd ansible

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å–µ —Ö–æ—Å—Ç—ã –¥–æ—Å—Ç—É–ø–Ω—ã
ansible all -i inventory/hosts -m ping

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –≥—Ä—É–ø–ø—É
ansible web_servers -i inventory/hosts -m ping
–®–∞–≥ 7: –ó–∞–ø—É—Å–∫–∞–µ–º –ø–ª–µ–π–±—É–∫–∏
bash
# –ë–∞–∑–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –≤—Å–µ—Ö —Ö–æ—Å—Ç–æ–≤
ansible-playbook -i inventory/hosts playbooks/common.yml

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤
ansible-playbook -i inventory/hosts playbooks/webservers.yml

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node Exporter
ansible-playbook -i inventory/hosts playbooks/node-exporter.yml

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Prometheus
ansible-playbook -i inventory/hosts playbooks/prometheus.yml

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Grafana
ansible-playbook -i inventory/hosts playbooks/grafana.yml
üéØ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–∫–æ–ø–∏–ø–∞—Å—Ç–∞ –∫–æ–º–∞–Ω–¥)
bash
# 1. –°–æ–∑–¥–∞—ë–º —Å–∫—Ä–∏–ø—Ç
cat > ansible/inventory/generate_inventory.sh << 'EOF'
#!/bin/bash
INVENTORY_FILE="inventory/hosts"
echo "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è inventory..." > $INVENTORY_FILE
VM_LIST=$(yc compute instance list --format json)
echo "[web_servers]" >> $INVENTORY_FILE
echo "[monitoring]" >> $INVENTORY_FILE
echo "[logging]" >> $INVENTORY_FILE
echo "[bastion]" >> $INVENTORY_FILE
echo "$VM_LIST" | jq -r '.[] | "\(.name) ansible_host=\(.network_interfaces[0].primary_v4_address.address) ansible_user=ubuntu"' >> $INVENTORY_FILE
sed -i '/web-server-/s/^/[web_servers] /' $INVENTORY_FILE
sed -i '/prometheus-vm\|grafana-vm/s/^/[monitoring] /' $INVENTORY_FILE
sed -i '/elasticsearch-vm\|kibana-vm/s/^/[logging] /' $INVENTORY_FILE
sed -i '/bastion-host/s/^/[bastion] /' $INVENTORY_FILE
sed -i '/^\[.*\]$/d' $INVENTORY_FILE
echo "" >> $INVENTORY_FILE
echo "[all:vars]" >> $INVENTORY_FILE
echo "ansible_ssh_private_key_file=~/.ssh/id_rsa" >> $INVENTORY_FILE
echo "Inventory —Å–æ–∑–¥–∞–Ω!"
EOF

# 2. –î–µ–ª–∞–µ–º –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º
chmod +x ansible/inventory/generate_inventory.sh
cd ansible
./inventory/generate_inventory.sh

# 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º
ansible all -i inventory/hosts -m ping
‚ö†Ô∏è –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–æ–±–ª–µ–º—ã:
–ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–º–∞–Ω–¥–∞ yc –Ω–µ –Ω–∞–π–¥–µ–Ω–∞
–†–µ—à–µ–Ω–∏–µ: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ YC CLI –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä—É—á–Ω–æ–π inventory

–ü—Ä–æ–±–ª–µ–º–∞: jq –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
–†–µ—à–µ–Ω–∏–µ: sudo apt install jq –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç

–ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–≤–µ—Ä–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (–Ω–µ ubuntu)
–†–µ—à–µ–Ω–∏–µ: –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏ –∑–∞–º–µ–Ω–∏—Ç–µ ansible_user=ubuntu –Ω–∞ –≤–∞—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ inventory! –•–æ—Ç–∏—Ç–µ —á—Ç–æ–±—ã —è –ø–æ–º–æ–≥ —Å –∫–∞–∫–∏–º-—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —à–∞–≥–æ–º?

–≠—Ç–æ—Ç –æ—Ç–≤–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω AI, —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏.
